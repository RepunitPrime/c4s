<div class="container">
  <div class="page-header">
    <span style="font-size: large; font-weight: bold; color:#428bca"> <%= @post.title %>

    </span>
    <span class="btn btn-link" style="float:right"><%= link_to 'Back to Offers', posts_path %></span>
  </div>

  <table>
    <tr style="">

      <% if @post.forSale == "sell" %>
          <!--along with td image is also responsive now-->
          <td style="width: 250px">
            <% if @post.image_file_name.nil? %>
                <span style="margin-right: 20px">  <%= image_tag('/No_Image.png', width: '92%', class: "img-rounded") %> </span>
            <% else %>
                <span style="margin-right: 20px"><%= image_tag(@post.image, :alt => "No Image", width: '92%', class: "img-rounded") %></span>
            <% end %>
          </td>
          <td style="vertical-align: text-top;">
            <p>
              <strong>Description:</strong>
              <%= @post.detail %>
            </p>

      <span><strong>Posted by: </strong>
        <% if !current_user.nil? && current_user.id == @post.user_id %>
        <span>You</span>
            <!--If added by current user -->
      <% else %>
        <span><%= User.find_by(id: @post.user_id).name %></span>
      <% end %>
    </span>

            <br><br>

            <p id="p_Modified_Teal">
              <spanp>&#8364;  </spanp>
              <% if @post.cost.nil? %>
                  0
              <% else %>
                  <%= @post.cost %>
              <% end %>
            </p>


            <br><br>

            <p>
              <% if (!current_user.nil? && current_user.id == @post.user_id) %>
                  <%= link_to 'Edit', edit_post_path(@post), class: 'btn btn-default' %>
              <% end %>
            </p>

          </td>
          <td>
          </td>

      <% elsif @post.forSale == "exchange" %>


          <td style="width: 250px">
            <% if @post.image_file_name.nil? %>
                <span style="margin-right: 20px">  <%= image_tag('/No_Image.png', width: '92%', class: "img-rounded") %> </span>
            <% else %>
                <span style="margin-right: 20px"><%= image_tag(@post.image, :alt => "No Image", width: '92%', class: "img-rounded") %></span>
            <% end %>
          </td>
          <td style="vertical-align: text-top;">
            <p>
              <strong>Description:</strong>
              <%= @post.detail %>
            </p>

      <span><strong>Posted by: </strong>
        <% if !current_user.nil? && current_user.id == @post.user_id %>
        <span>You</span>
            <!--If added by current user -->
      <% else %>
        <span><%= User.find_by(id: @post.user_id).name %></span>
      <% end %>
    </span>

            <br><br>

            <p>

              <% if @post.bookexpected.empty? %>
                <p id="p_Modified_Grey">
                  Preferable book for exchange : ----
                </p>
            <% else %>
                <p id="p_Modified_TealExch">
                  <%= 'Preferable book for Exchange : ' + @post.bookexpected %>
                </p>
            <% end %>
            </p>


            <br><br>

            <p>
              <% if (!current_user.nil? && current_user.id == @post.user_id) %>
                  <%= link_to 'Edit', edit_post_path(@post), class: 'btn btn-default' %>
              <% end %>
            </p>

          </td>
          <td>
          </td>


      <% end %>


    </tr>
  </table>

  <hr>
  <!--Add a Comment -->
  <div class="well">
    <h3>Leave a Comment:</h3>
    <%= form_for([@post, @post.ad_comments.build]) do |f| %>
        <p>
          <%= f.text_area :comment_body, class: 'form-control' %>
        </p>
        <p>
          <button type="submit" name="commit" class="huge ui positive icon button">
            <i class="save icon"></i>Add Comment
          </button>
        </p>
    <% end %>
  </div>

  <!-- Comment -->
  <% if @post.ad_comments.size != 0 %>
      <h3 class="page-header">Comments</h3>
      <% @post.ad_comments.each do |comment| %>
          <% if !comment.user_id.nil? %>
              <div class="media">
                <% if User.find(comment.user_id).profile_pic_file_name.nil? %>
                    <a class="pull-left" href="#">
                      <%= image_tag('/Profile_Avatar.png', :id => "Image_Tag_Thumbnail", :class => "media-object", :alt => "No Image") %>
                    </a>
                <% else %>
                    <a class="pull-left" href="#">
                      <%= image_tag(User.find(comment.user_id).profile_pic, :id => "Image_Tag_Thumbnail", :alt => "No Image") %>
                    </a>
                <% end %>
                <div class="media-body">
                  <h2 class="media-heading"><%= User.find(comment.user_id).username %>
                    <small><%= comment.created_at.to_datetime.strftime("%b %d, %Y at %r") %></small>
                    <% if !current_user.nil? && current_user.id == comment.user_id %>
                        <button class="big ui button pull-right" id="test" data-toggle="modal" data-comment-id="<%= comment.id %>" data-target="#myCommentDeleteModal">
                          <i class="remove icon"></i>Delete
                        </button>
                    <% end %>
                  </h2>
                  <%= comment.comment_body %>
                </div>
              </div>
          <% end %>
      <% end %>
  <% end %>

  <!-- Modal -->
  <div class="modal fade" id="myCommentDeleteModal" role="dialog">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Delete Comment</h4>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this comment?</p>
        </div>
        <div class="modal-footer">
          <a rel="nofollow" data-method="delete" href="">
            <button class="big ui button"><i class="checkmark icon"></i>Yes</button>
          </a>
          <button type="button" class="big ui button" data-dismiss="modal"><i class="remove icon"></i>No</button>
        </div>
      </div>
    </div>
  </div>

  <script>

    $('#myCommentDeleteModal').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget) // Button that triggered the modal
      var commentId = button.data('comment-id') // Extract info from data-* attributes
      // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
      // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
      var modal = $(this)
      modal.find('.modal-footer a').attr("href", "<%=post_ad_comments_path(@post.id)  %>/" + commentId);
    })

  </script>

</div>